# Workflow: /smartspec_generate_component_registry

**สแกนไลบรารีคอมโพเนนต์และสร้างไฟล์รีจิสทรีคอมโพเนนต์สำหรับตัวแสดงผล UI ที่ขับเคลื่อนด้วย JSON โดยอัตโนมัติ**

---

## 1. ภาพรวม

เวิร์กโฟลว์นี้ช่วยสร้างและบำรุงรักษาไฟล์ `component-registry.ts` โดยอัตโนมัติ ไฟล์นี้มีความสำคัญอย่างยิ่งสำหรับระบบ UI ที่ขับเคลื่อนด้วย JSON เนื่องจากทำหน้าที่แมปคีย์คอมโพเนนต์ (เช่น `"type": "card"`) ใน A2UI JSON กับการใช้งานคอมโพเนนต์ React จริง การทำกระบวนการนี้ให้เป็นอัตโนมัติช่วยลดข้อผิดพลาดของมนุษย์ที่พบบ่อยซึ่งนักพัฒนาลืมลงทะเบียนคอมโพเนนต์ใหม่ ซึ่งนำไปสู่ความล้มเหลวขณะรันไทม์

## 2. หมวดหมู่

`project_management_and_support`

## 3. พารามิเตอร์

### พารามิเตอร์ที่จำเป็น

| พารามิเตอร์ | ประเภท | คำอธิบาย |
| :--- | :--- | :--- |
| `--scan-dir` | string | ไดเรกทอรีที่มีคอมโพเนนต์ React ที่จะลงทะเบียน (เช่น `src/components/custom/`) |
| `--output-file` | string | เส้นทางไปยังไฟล์ `component-registry.ts` ที่ส่งออก |

### พารามิเตอร์ที่ไม่จำเป็น

| พารามิเตอร์ | ประเภท | ค่าเริ่มต้น | คำอธิบาย |
| :--- | :--- | :--- | :--- |
| `--base-registry` | string | `null` | เส้นทางที่ไม่บังคับไปยังไฟล์ JSON ที่กำหนดชุดคอมโพเนนต์พื้นฐานที่จะรวม (เช่น จากไลบรารีอย่าง MUI) คีย์คือชื่อคอมโพเนนต์และค่าคือแหล่งที่มาของการนำเข้า |

## 4. ตัวอย่างการใช้งาน

### สร้างรีจิสทรีเริ่มต้น

**คำสั่ง:**
```bash
/smartspec_generate_component_registry \
  --scan-dir "src/components/business/" \
  --output-file "src/config/component-registry.ts" \
  --base-registry "src/config/base-components.json"
```

**ผลลัพธ์:**
- สคริปต์จะสแกนไฟล์ `.tsx` ทั้งหมดใน `src/components/business/` ค้นหา named exports ทั้งหมด และสร้างไฟล์ `component-registry.ts` ไฟล์นี้จะมีการนำเข้าสำหรับคอมโพเนนต์ที่ค้นพบทั้งหมดและออบเจกต์ `ComponentMapper` ที่แมปชื่อสตริงกับการใช้งานคอมโพเนนต์ นอกจากนี้ยังรวมถึงคอมโพเนนต์ที่กำหนดใน `base-components.json`

---

### รันใน CI/CD Pipeline

**คำสั่ง:**
```bash
# คำสั่งนี้สามารถเพิ่มไปยัง pre-commit hook หรือ CI job
/smartspec_generate_component_registry \
  --scan-dir "src/components/" \
  --output-file "src/config/component-registry.ts"
```

**ผลลัพธ์:**
- ทำให้แน่ใจว่ารีจิสทรีคอมโพเนนต์ซิงค์กับไลบรารีคอมโพเนนต์อยู่เสมอ ป้องกันข้อผิดพลาดขณะรันไทม์จากคอมโพเนนต์ที่ไม่ได้ลงทะเบียน

## 5. หมายเหตุ

- เวิร์กโฟลว์นี้ออกแบบมาให้รันบ่อยๆ โดยเฉพาะในสภาพแวดล้อม CI/CD
- สคริปต์ใช้นิพจน์ทั่วไปในการแยกวิเคราะห์การส่งออกและอาจไม่ครอบคลุมทุกกรณีของไวยากรณ์ TypeScript ได้รับการปรับให้เหมาะสมสำหรับรูปแบบทั่วไปเช่น `export const MyComponent = ...` และ `export { MyComponent }`
- ปัจจุบันการส่งออกเริ่มต้นจะถูกละเว้น ขอแนะนำให้ใช้ named exports สำหรับคอมโพเนนต์ทั้งหมดในไลบรารีของคุณเพื่อความสอดคล้องกัน
