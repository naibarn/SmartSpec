_**หมายเหตุ:** นี่คือคู่มือการใช้งานสำหรับเวิร์กโฟลว์ `smartspec_import_penpot_tokens` สำหรับคำจำกัดความทางเทคนิคของเวิร์กโฟลว์ โปรดดูที่ [`.smartspec/workflows/smartspec_import_penpot_tokens.md`](../../.smartspec/workflows/smartspec_import_penpot_tokens.md)_ 

# เวิร์กโฟลว์: smartspec_import_penpot_tokens

## 1. ภาพรวม

เวิร์กโฟลว์ `smartspec_import_penpot_tokens` เป็นเครื่องมืออันทรงพลังที่ออกแบบมาเพื่อเชื่อมช่องว่างระหว่างการออกแบบและการพัฒนาโดยการนำเข้า design tokens จาก **Penpot** ซึ่งเป็นแพลตฟอร์มการออกแบบและสร้างต้นแบบโอเพนซอร์สโดยอัตโนมัติ เวิร์กโฟลว์นี้ช่วยให้คุณสามารถแปลระบบการออกแบบที่คุณสร้างใน Penpot ให้เป็นไฟล์ `theme.json` ที่ใช้งานได้สำหรับแอปพลิเคชัน SmartSpec A2UI ของคุณได้โดยตรง

ด้วยการทำให้กระบวนการนี้เป็นไปโดยอัตโนมัติ คุณสามารถมั่นใจได้ว่าสภาพแวดล้อมการพัฒนาของคุณจะซิงค์กับการตัดสินใจด้านการออกแบบล่าสุดอยู่เสมอ ช่วยลดข้อผิดพลาดจากการทำงานด้วยตนเองและเร่งกระบวนการจากดีไซน์สู่โค้ดได้อย่างมีนัยสำคัญ

## 2. คุณสมบัติหลัก

- **การผสานรวมกับ Penpot โดยตรง:** นำเข้าโทเค็นโดยตรงจาก Penpot โดยใช้ API หรือจากไฟล์ JSON ที่ส่งออก
- **การจับคู่โทเค็นอัตโนมัติ:** จับคู่คลังสี, สไตล์ข้อความ, และคอมโพเนนต์ของ Penpot กับโครงสร้าง `theme.json` ของ SmartSpec อย่างชาญฉลาด
- **กลยุทธ์การรวมที่ยืดหยุ่น:** ให้การควบคุมวิธีการรวมโทเค็นที่นำเข้าเข้ากับธีมที่มีอยู่ ทำให้คุณสามารถรวม, เขียนทับ, หรือผนวกโทเค็นใหม่ได้
- **เวิร์กโฟลว์ที่ราบรื่น:** ผสานรวมเข้ากับ `smartspec_manage_theme` และเวิร์กโฟลว์ A2UI อื่นๆ ได้อย่างสมบูรณ์แบบ

## 3. การผสานรวมกับ Penpot

เวิร์กโฟลว์นี้มีสองวิธีในการนำเข้าโทเค็นจาก Penpot

### วิธีที่ 1: นำเข้าจากไฟล์

นี่เป็นวิธีที่ง่ายที่สุด คุณสามารถส่งออกไฟล์ดีไซน์ Penpot ของคุณเป็นไฟล์ JSON และส่งให้เวิร์กโฟลว์

**วิธีส่งออกจาก Penpot:**
1.  เปิดไฟล์ดีไซน์ของคุณใน Penpot
2.  ไปที่ **เมนูหลัก** (มุมบนซ้าย)
3.  เลือก **ส่งออก (Export)**
4.  เลือกตัวเลือก **ส่งออกเป็น JSON (Export as JSON)**
5.  บันทึกไฟล์ลงในโปรเจกต์ของคุณ

### วิธีที่ 2: นำเข้าจาก API

สำหรับการตั้งค่าการผสานรวมอย่างต่อเนื่องและอัตโนมัติมากขึ้น คุณสามารถนำเข้าโทเค็นโดยตรงจาก Penpot API ได้ วิธีนี้ต้องการให้คุณระบุ URL ของอินสแตนซ์ Penpot, ID โปรเจกต์, ID ไฟล์, และ access token

**วิธีรับ access token ของ API:**
1.  ใน Penpot ไปที่ **การตั้งค่า (Settings)** หรือโปรไฟล์ผู้ใช้ของคุณ
2.  ค้นหาส่วน **Access Tokens** หรือ **API**
3.  สร้าง access token ใหม่พร้อมกับสิทธิ์ที่จำเป็น
4.  คัดลอกโทเค็นอย่างปลอดภัย ขอแนะนำให้เก็บไว้เป็นตัวแปรสภาพแวดล้อมแทนที่จะเขียนโค้ดแบบตายตัวในคำสั่งของคุณ

## 4. พารามิเตอร์

พฤติกรรมของเวิร์กโฟลว์ถูกควบคุมโดยพารามิเตอร์ต่อไปนี้

### พารามิเตอร์ที่จำเป็น

| พารามิเตอร์ | ประเภท | คำอธิบาย |
| :--- | :--- | :--- |
| `--source` | string | แหล่งที่มาของโทเค็น Penpot ต้องเป็น `file` หรือ `api` |

### พารามิเตอร์ที่ไม่บังคับ

| พารามิเตอร์ | ประเภท | คำอธิบาย | จำเป็นสำหรับ |
| :--- | :--- | :--- | :--- |
| `--input-file` | string | เส้นทางไปยังไฟล์ Penpot JSON ที่ส่งออก | แหล่งที่มา `file` |
| `--penpot-url` | string | URL ของอินสแตนซ์ Penpot ของคุณ ค่าเริ่มต้นคือ `https://design.penpot.app` | แหล่งที่มา `api` |
| `--project-id` | string | ID ของโปรเจกต์ Penpot ของคุณ | แหล่งที่มา `api` |
| `--file-id` | string | ID ของไฟล์ Penpot ที่มี design tokens | แหล่งที่มา `api` |
| `--access-token` | string | access token ของ Penpot API ของคุณ | แหล่งที่มา `api` |
| `--merge-strategy` | string | กำหนดวิธีจัดการกับความขัดแย้งกับธีมที่มีอยู่ ค่าเริ่มต้นคือ `merge` | ทุกแหล่งที่มา |
| `--theme-file` | string | เส้นทางไปยังไฟล์ `theme.json` ค่าเริ่มต้นคือ `.spec/theme.json` | ทุกแหล่งที่มา |

### กลยุทธ์การรวม (Merge Strategies)

พารามิเตอร์ `--merge-strategy` ให้คุณควบคุมกระบวนการนำเข้าได้อย่างละเอียด:

- **`merge` (ค่าเริ่มต้น):** รวมโทเค็นที่นำเข้าเข้ากับธีมที่มีอยู่ หากมีโทเค็นอยู่แล้ว ค่าปัจจุบันของมันจะถูกเก็บไว้
- **`overwrite`:** แทนที่ธีมที่มีอยู่ทั้งหมดด้วยโทเค็นที่นำเข้า ใช้ด้วยความระมัดระวัง เนื่องจากจะลบโทเค็นที่คุณกำหนดเองทั้งหมด
- **`append`:** เพิ่มเฉพาะโทเค็นใหม่จากไฟล์ Penpot เท่านั้น โทเค็นที่มีอยู่จะถูกข้ามไปและไม่ถูกแตะต้อง

## 5. ตัวอย่างการใช้งาน

นี่คือสถานการณ์ทั่วไปบางส่วนสำหรับการใช้เวิร์กโฟลว์นี้

### กรณีการใช้งานที่ 1: การเริ่มต้นโปรเจกต์ใหม่จากดีไซน์ใน Penpot

คุณมีระบบการออกแบบที่สมบูรณ์ใน Penpot และต้องการสร้าง `theme.json` ใหม่จากมัน

**คำสั่ง:**
```bash
# ก่อนอื่น ส่งออกไฟล์ Penpot ของคุณไปที่ design/design-system.json

/smartspec_import_penpot_tokens \
  --source file \
  --input-file design/design-system.json \
  --merge-strategy overwrite
```

**ผลลัพธ์:** `theme.json` ใหม่จะถูกสร้างขึ้นที่ `.spec/theme.json` ซึ่งมีสี, typography, และสไตล์คอมโพเนนต์ทั้งหมดจากไฟล์ Penpot ของคุณ

### กรณีการใช้งานที่ 2: การซิงค์การอัปเดตดีไซน์จาก Penpot API

ทีมออกแบบของคุณได้อัปเดตสีของแบรนด์ใน Penpot และคุณต้องการซิงค์การเปลี่ยนแปลงเหล่านี้เข้ากับธีมที่มีอยู่โดยไม่สูญเสียโทเค็นที่คุณกำหนดเอง

**คำสั่ง:**
```bash
# สมมติว่า PENPOT_TOKEN เป็นตัวแปรสภาพแวดล้อม
/smartspec_import_penpot_tokens \
  --source api \
  --project-id "a1b2c3d4-e5f6-7890-abcd-ef1234567890" \
  --file-id "f1e2d3c4-b5a6-9870-fedc-ba0987654321" \
  --access-token $PENPOT_TOKEN \
  --merge-strategy merge
```

**ผลลัพธ์:** เวิร์กโฟลว์จะดึงโทเค็นล่าสุดจาก Penpot API มันจะอัปเดตโทเค็นที่เปลี่ยนแปลงและเพิ่มโทเค็นใหม่ แต่จะเก็บโทเค็นที่มีอยู่ซึ่งไม่ได้เป็นส่วนหนึ่งของการนำเข้าไว้ ด้วยกลยุทธ์ `merge`

### กรณีการใช้งานที่ 3: การผนวกสไตล์คอมโพเนนต์ใหม่

ทีมของคุณได้ออกแบบชุดคอมโพเนนต์ใหม่ใน Penpot และคุณต้องการเพิ่มมันเข้าไปในธีมของคุณโดยไม่ส่งผลกระทบต่อโทเค็นที่มีอยู่

**คำสั่ง:**
```bash
/smartspec_import_penpot_tokens \
  --source file \
  --input-file design/new-components.json \
  --merge-strategy append
```

**ผลลัพธ์:** เฉพาะสไตล์คอมโพเนนต์ใหม่จากไฟล์ Penpot เท่านั้นที่จะถูกเพิ่มเข้าไปใน `theme.json` ของคุณ โทเค็นและสไตล์คอมโพเนนต์ที่มีอยู่ทั้งหมดจะไม่เปลี่ยนแปลง

## 6. ตรรกะการจับคู่โทเค็น

เวิร์กโฟลว์ใช้การจับคู่อย่างชาญฉลาดเพื่อแปลงโครงสร้างของ Penpot เป็นรูปแบบธีมของ SmartSpec

| องค์ประกอบ Penpot | เส้นทาง SmartSpec | ตรรกะการจับคู่ |
| :--- | :--- | :--- |
| คลังสี (Color Libraries) | `tokens.colors.*` | ชื่อคลังจะถูกทำให้เป็นมาตรฐาน (เช่น "Primary Colors" กลายเป็น `primary`) ชื่อสีที่มีตัวเลข (เช่น "Blue 500") จะถูกจับคู่กับเฉดสีที่สอดคล้องกัน |
| สไตล์ข้อความ (Text Styles) | `tokens.typography.*` | ชื่อสไตล์จะถูกทำให้เป็นมาตรฐาน Font family, size, weight, และ line height จะถูกดึงออกมาและวางไว้ในส่วนย่อยของ typography ที่เหมาะสม |
| คอมโพเนนต์ (Components) | `components.*.variants.*` | คอมโพเนนต์ของ Penpot จะถูกจับคู่กับ component variants ในธีม ทำให้คุณสามารถนำกลับมาใช้ใหม่ใน UI specs ของคุณได้ |

## 7. เวิร์กโฟลว์ที่เกี่ยวข้อง

- **`smartspec_manage_theme`**: หลังจากนำเข้า คุณสามารถใช้เวิร์กโฟลว์นี้เพื่อจัดการ, ตรวจสอบ, หรือส่งออกธีมของคุณต่อไป
- **`smartspec_generate_ui_spec`**: เวิร์กโฟลว์นี้ใช้ไฟล์ `theme.json` เพื่อสร้าง A2UI specifications ที่มีสไตล์ที่สอดคล้องกัน
