# /smartspec_project_copilot คู่มือ (v6.0, ภาษาไทย)

## ภาพรวม

workflow `/smartspec_project_copilot` (เวอร์ชัน 6.0.7) ทำหน้าที่เป็น **ประตูหน้าแบบอ่านอย่างเดียว** และที่ปรึกษาการกำกับดูแลสำหรับโปรเจกต์ที่เปิดใช้งาน SmartSpec

วัตถุประสงค์หลักคือการตอบคำถามที่เกี่ยวข้องกับโปรเจกต์ โดเมน หรือสเปค โดยการวิเคราะห์หลักฐานที่มีอยู่ในโปรเจกต์ (ดัชนี, รีจิสทรี, สเปค, แผนงาน, งาน และรายงาน) จากหลักฐานเหล่านี้ จะสรุปสถานะโปรเจกต์ และที่สำคัญคือ นำทางผู้ใช้ไปยัง **workflow และคำสั่ง SmartSpec ที่ถูกต้องถัดไป** ซึ่งจำเป็นสำหรับการพัฒนาโปรเจกต์ต่อไป

**ลักษณะสำคัญ:**

*   **บทบาท:** การกำกับดูแลระดับโปรเจกต์, ที่ปรึกษา และตัวนำทาง
*   **ความปลอดภัย:** เข้มงวดแบบ **ไม่เขียนข้อมูลใดๆ** (`write_guard: NO-WRITE`) ไม่แก้ไขไฟล์โปรเจกต์ สเปค หรือรีจิสทรีใดๆ
*   **หลักฐานเป็นที่ตั้ง:** คำตอบได้มาจากหลักฐานที่มีอยู่ในโปรเจกต์เท่านั้น ไม่ได้สรุปจากรายการตรวจสอบง่ายๆ
*   **คำสั่งถูกต้อง:** แนะนำเฉพาะ workflow และ flags ของ SmartSpec ที่ถูกต้อง ป้องกันการสร้างคำสั่งที่ผิดพลาด
*   **ประเภท:** เครื่องมืออรรถประโยชน์

## การใช้งาน

### การใช้งาน CLI

copilot ถูกเรียกใช้งานผ่าน SmartSpec CLI โดยใส่คำถามของผู้ใช้เป็นอาร์กิวเมนต์แรก

```bash
/smartspec_project_copilot "<question>" \
  [--domain <name>] \
  [--spec-id <id>] \
  [--spec-path <path>] \
  [--aspect status|roadmap|security|ci|ui|perf|all] \
  [--report <path>] \
  [--format markdown|plain|json] \
  [--short] \
  [--repos-config <path>] \
  [--workspace-roots <root1,root2,...>] \
  [--registry-roots <dir1,dir2,...>] \
  [--out <safe_reports_root>] \
  [--json]
```

### การใช้งาน Kilo Code

เมื่อผนวก copilot เข้ากับสภาพแวดล้อม Kilo Code (เช่น ส่วนขยาย IDE หรือแพลตฟอร์ม) การใช้ flag `--kilocode` จะระบุบริบทการทำงาน

```bash
/smartspec_project_copilot.md "<question>" --kilocode \
  [--domain <name>] [--spec-id <id>] [--spec-path <path>] [--aspect ...] \
  [--report <path>] [--format ...] [--short] \
  [--repos-config <path>] [--workspace-roots ...] [--registry-roots ...] \
  [--out <safe_reports_root>] \
  [--json]
```

## กรณีการใช้งาน

### กรณีการใช้งาน 1: ตรวจสอบความก้าวหน้าของโปรเจกต์และขั้นตอนถัดไป

**สถานการณ์:** ผู้จัดการโปรเจกต์ต้องการทราบสถานะปัจจุบันของสเปค `user-auth-v2` และขั้นตอนถัดไปที่ควรทำ

**คำสั่ง CLI:**

```bash
/smartspec_project_copilot "สถานะของสเปค user-auth-v2 เป็นอย่างไร และฉันควรทำอะไรต่อ?" \
  --spec-id user-auth-v2 \
  --aspect status
```

**ผลลัพธ์ที่คาดหวัง:**

copilot สแกนโปรเจกต์ พบไฟล์ `specs/auth/user-auth-v2/spec.md` และตรวจสอบ `tasks.md` และรายงานที่เกี่ยวข้อง

1.  **สรุปสถานะ:** *สเปค `user-auth-v2` สมบูรณ์แล้ว มีไฟล์ `tasks.md` ที่เกี่ยวข้องแต่ยังไม่ได้รับการตรวจสอบตั้งแต่สัปดาห์ที่แล้ว*
2.  **ปัญหาสำคัญ:** *ไม่พบปัญหาสำคัญ แต่การตรวจสอบล้าสมัย*
3.  **Workflow & คำสั่งที่แนะนำ:**
    *   **เพื่อยืนยันความก้าวหน้า:** `/smartspec_verify_tasks_progress_strict specs/auth/user-auth-v2/tasks.md`
    *   **หากการตรวจสอบล้มเหลว:** `/smartspec_generate_code specs/auth/user-auth-v2/spec.md --language typescript`

### กรณีการใช้งาน 2: ค้นหาช่องโหว่ด้านความปลอดภัย

**สถานการณ์:** ผู้ตรวจสอบความปลอดภัยต้องการสรุปอย่างรวดเร็วเกี่ยวกับปัญหาความปลอดภัยที่เปิดอยู่ในรายงานหรือสเปค โดยเน้นที่แง่มุม `security`

**คำสั่ง CLI:**

```bash
/smartspec_project_copilot "มีช่องโหว่ด้านความปลอดภัยที่เปิดอยู่หรือมาตรการแก้ไขที่รอดำเนินการในโปรเจกต์หรือไม่?" \
  --aspect security \
  --format markdown
```

**ผลลัพธ์ที่คาดหวัง:**

copilot สแกน `.spec/reports/**` เพื่อหารายงานที่เกี่ยวข้องกับความปลอดภัย และไฟล์ `spec.md` ที่ติดแท็กปัญหาความปลอดภัย

1.  **สรุปสถานะ:** *พบปัญหาระดับกลาง 2 รายการที่เปิดอยู่: การส่งข้อมูลที่ไม่ปลอดภัย (รายงาน ID 456) และการพึ่งพาที่ยังไม่ได้แพตช์ (รายงาน ID 789)*
2.  **ปัญหาสำคัญ:** *การพึ่งพาที่ยังไม่ได้แพตช์ต้องได้รับการแก้ไขทันที*
3.  **Workflow & คำสั่งที่แนะนำ:**
    *   **เพื่อสร้างแผนการแก้ไข:** `/smartspec_generate_plan .spec/reports/security/report_789.json --type mitigation`
    *   **เพื่ออัปเดตรีจิสทรีของการพึ่งพา:** `/smartspec_update_registry --type dependencies --id vulnerable-lib`

### กรณีการใช้งาน 3: การผนวก Kilo Code สำหรับการนำทาง workflow

**สถานการณ์:** นักพัฒนาที่ใช้ IDE ที่รองรับ Kilo Code ถามคำถามทั่วไปเกี่ยวกับความก้าวหน้าการดำเนินงาน

**คำสั่ง Kilo Code:**

```bash
/smartspec_project_copilot.md "ตอนนี้เราก้าวหน้าในการดำเนินงานถึงไหน? ฉันไม่เห็นไฟล์ tasks" --kilocode
```

**ผลลัพธ์ที่คาดหวัง (ใช้กฎการนำทาง):**

เนื่องจากนักพัฒนาไม่แน่ใจและไม่มีการระบุเส้นทาง `tasks.md` กฎการนำทางบังคับสำหรับคำถามเกี่ยวกับความก้าวหน้าจะถูกเรียกใช้

1.  **สรุปสถานะ:** *ไม่สามารถระบุความก้าวหน้าการดำเนินงานที่แน่นอนได้โดยไม่มีรายการงานที่ได้รับการตรวจสอบ*
2.  **ปัญหาสำคัญ:** *ขาดหลักฐานที่ตรวจสอบได้สำหรับความก้าวหน้า*
3.  **Workflow & คำสั่งที่แนะนำ:**
    *   **ขั้นแรก ค้นหาสเปคที่เกี่ยวข้อง (เช่น `specs/feature/new_api/spec.md`)**
    *   **จากนั้น สร้างงาน:** `/smartspec_generate_tasks specs/feature/new_api/spec.md --apply`
    *   **สุดท้าย ยืนยันความก้าวหน้า:** `/smartspec_verify_tasks_progress_strict specs/feature/new_api/tasks.md`

## พารามิเตอร์

| Parameter/Flag | Type | Description | Default |
| :--- | :--- | :--- | :--- |
| `<question>` | String | **จำเป็น.** คำถามหรือคำสืบค้นของผู้ใช้สำหรับ copilot | N/A |
| `--domain` | String | กรองขอบเขตไปยังชื่อโดเมนเฉพาะ | ทุกโดเมน |
| `--spec-id` | String | กรองขอบเขตไปยังรหัสสเปคเฉพาะ | ทุกสเปค |
| `--spec-path` | Path | กรองขอบเขตไปยังเส้นทางไฟล์สเปคเฉพาะ (เช่น `specs/auth/login/spec.md`) | ทุกสเปค |
| `--aspect` | Enum | จำกัดขอบเขตคำตอบให้แคบลง ค่าที่ใช้ได้: `status`, `roadmap`, `security`, `ci`, `ui`, `perf`, `all` | `all` |
| `--report` | Path | กำหนดให้ copilot รวมรายงานไฟล์เฉพาะเป็นหลักฐานหลัก | ไม่มี |
| `--format` | Enum | กำหนดรูปแบบผลลัพธ์ ค่าที่ใช้ได้: `markdown`, `plain`, `json` | `markdown` |
| `--short` | Boolean | ขอคำตอบที่กระชับและสั้น | False |
| `--repos-config` | Path | เส้นทางไปยังไฟล์กำหนดค่าที่เก็บซอร์สโค้ด | N/A |
| `--workspace-roots` | List[Path] | รายการไดเรกทอรีรากที่คั่นด้วยเครื่องหมายจุลภาคเพื่อสแกน | พื้นที่ทำงานปัจจุบัน |
| `--registry-roots` | List[Path] | รายการไดเรกทอรีที่มีรีจิสทรีแบบอ่านอย่างเดียว คั่นด้วยเครื่องหมายจุลภาค | รีจิสทรีเริ่มต้น |
| `--out` | Path | เส้นทางทางเลือกสำหรับ orchestrator ในการเขียนรายงานชั่วคราวที่ปลอดภัย | N/A |
| `--json` | Boolean | แสดงผลลัพธ์ทั้งหมดในรูปแบบ JSON (แทนที่ `--format`) | False |
| `--config` | Path | เส้นทางไปยังไฟล์กำหนดค่า SmartSpec | `.spec/smartspec.config.yaml` |
| `--lang` | Enum | ภาษาผลลัพธ์ ค่าที่ใช้ได้: `en`, `th`, `auto` | `auto` |
| `--platform` | Enum | ตัวบ่งชี้แพลตฟอร์มการทำงาน ค่าที่ใช้ได้: `cli`, `kilo`, `ci`, `other` | `cli` |
| `--quiet` | Boolean | ปิดการแสดงผลที่ไม่จำเป็น | False |
| `--kilocode` | Boolean | ตัวบ่งชี้โหมดแพลตฟอร์ม (ใช้ในตัวอย่าง Kilo Code) | False |

## ผลลัพธ์

ผลลัพธ์หลักคือคำตอบที่ให้คำแนะนำ ซึ่งจัดโครงสร้างตามรูปแบบบังคับดังนี้:

1.  **สรุปสถานะ:** ภาพรวมระดับสูงของขอบเขต
2.  **ปัญหาสำคัญ & การแก้ไข:** ปัญหาที่เป็นอุปสรรคที่พบในหลักฐาน
3.  **ไทม์ไลน์ / แผนงานเป็นช่วง:** (ถ้ามี) ไทม์ไลน์ที่คาดการณ์จากแผนงาน/รายงานที่มีอยู่
4.  **Workflow & คำสั่ง SmartSpec ที่แนะนำ:** ส่วนสำคัญที่สุด ให้คำสั่งที่ตรวจสอบแล้วและพร้อมใช้งานสำหรับการดำเนินการถัดไปของผู้ใช้
5.  **การตรวจสอบจุดอ่อน & ความเสี่ยง:** ความโปร่งใสเกี่ยวกับข้อจำกัดใดๆ (เช่น ดัชนีที่ขาดหาย, พฤติกรรมสำรอง, การแก้ไขข้อมูล)

**ผลลัพธ์ที่บันทึกไว้ (ถ้ามี):**

หาก orchestrator ใช้ flag `--out`