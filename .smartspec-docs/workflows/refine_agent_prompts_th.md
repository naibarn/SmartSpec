_**หมายเหตุ:** นี่คือคู่มือการใช้งานสำหรับเวิร์กโฟลว์ `smartspec_refine_agent_prompts` สำหรับคำจำกัดความทางเทคนิคของเวิร์กโฟลว์ โปรดดูที่ [`.smartspec/workflows/smartspec_refine_agent_prompts.md`](../../.smartspec/workflows/smartspec_refine_agent_prompts.md)_ 

# เวิร์กโฟลว์: smartspec_refine_agent_prompts

## 1. ภาพรวม

เวิร์กโฟลว์ `smartspec_refine_agent_prompts` นำเสนอ **วงจรความคิดเห็นของ AI (AI feedback loop)** ที่ทรงพลังเข้ามาในกระบวนการพัฒนาของคุณ มันช่วยลดช่องว่างระหว่างการสร้าง UI และการใช้งานจริงโดยการวิเคราะห์ข้อมูลการวิเคราะห์ UI เพื่อให้คำแนะนำที่สามารถนำไปปฏิบัติได้สำหรับการปรับปรุงพรอมต์ของ AI agent ของคุณ ด้วยการเรียนรู้จากพฤติกรรมของผู้ใช้และเมตริกประสิทธิภาพ เวิร์กโฟลว์นี้ช่วยให้คุณปรับปรุงคุณภาพ, การใช้งาน, และประสิทธิภาพของแอปพลิเคชันที่สร้างโดย A2UI ของคุณได้อย่างต่อเนื่อง

เวิร์กโฟลว์นี้เป็นองค์ประกอบสำคัญของวงจรการพัฒนาที่ขับเคลื่อนด้วยข้อมูล, เปลี่ยนข้อมูลการวิเคราะห์ดิบให้เป็นการทำ prompt engineering ที่ชาญฉลาด

## 2. วงจรความคิดเห็นของ AI (AI Feedback Loop)

เวิร์กโฟลว์นี้ทำงานบนหลักการที่เรียบง่ายแต่ทรงพลัง: **เรียนรู้จากข้อมูล, ปรับปรุงพรอมต์, และปรับปรุงผลลัพธ์**

1.  **รวบรวมข้อมูล:** กระบวนการเริ่มต้นด้วยข้อมูลการวิเคราะห์ที่สร้างโดยเวิร์กโฟลว์ `smartspec_ui_analytics_reporter` ข้อมูลนี้มีเมตริกที่มีค่าเกี่ยวกับการใช้งานคอมโพเนนต์, การโต้ตอบของผู้ใช้, ประสิทธิภาพ, และการเข้าถึง
2.  **วิเคราะห์รูปแบบ:** เวิร์กโฟลว์ `smartspec_refine_agent_prompts` จะนำเข้าข้อมูลนี้และใช้ความฉลาดในตัวเพื่อตรวจจับรูปแบบและระบุปัญหาทั่วไป ตัวอย่างเช่น อาจพบว่าปุ่มบางประเภทมีอัตราการคลิกผ่านต่ำมากหรือรูปภาพจำนวนมากไม่มี alt text
3.  **สร้างคำแนะนำ:** สำหรับแต่ละปัญหาที่ระบุ เวิร์กโฟลว์จะสร้างคำแนะนำที่เฉพาะเจาะจงและนำไปปฏิบัติได้สำหรับการปรับปรุงพรอมต์ของ AI agent ที่น่าจะสร้าง UI นั้น คำแนะนำเหล่านี้รวมถึงคำอธิบายที่ชัดเจนของปัญหา, การปรับปรุงที่เสนอสำหรับพรอมต์, และผลกระทบที่คาดหวัง
4.  **นำไปใช้และทำซ้ำ:** คุณสามารถตรวจสอบคำแนะนำเหล่านี้และนำไปใช้กับเทมเพลตพรอมต์ของคุณได้ เมื่อเวลาผ่านไป กระบวนการทำซ้ำนี้จะนำไปสู่พรอมต์ที่มีคุณภาพสูงขึ้นซึ่งสร้าง UI specifications ที่มีประสิทธิภาพและเป็นมิตรกับผู้ใช้มากขึ้นตั้งแต่เริ่มต้น

## 3. พารามิเตอร์

เวิร์กโฟลว์สามารถกำหนดค่าได้โดยใช้พารามิเตอร์ต่อไปนี้

### พารามิเตอร์ที่จำเป็น

| พารามิเตอร์ | ประเภท | คำอธิบาย |
| :--- | :--- | :--- |
| `--analytics-file` | string | เส้นทางไปยังไฟล์ JSON การวิเคราะห์ที่สร้างโดย `smartspec_ui_analytics_reporter` |

### พารามิเตอร์ที่ไม่บังคับ

| พารามิเตอร์ | ประเภท | คำอธิบาย | ค่าเริ่มต้น |
| :--- | :--- | :--- | :--- |
| `--focus-area` | string | พื้นที่เฉพาะที่จะมุ่งเน้นการวิเคราะห์ (เช่น `accessibility`, `performance`) | `all` |
| `--output-format` | string | รูปแบบสำหรับรายงานผลลัพธ์ (`markdown`, `json`, หรือ `both`) | `markdown` |
| `--output-file` | string | เส้นทางที่จะบันทึกรายงานที่สร้างขึ้น | `.spec/prompt_refinements.md` |
| `--threshold` | number | เกณฑ์ความเชื่อมั่น (0.0-1.0) สำหรับคำแนะนำ เฉพาะคำแนะนำที่มีคะแนนความเชื่อมั่นสูงกว่าค่านี้เท่านั้นที่จะถูกรวมไว้ | `0.7` |
| `--include-examples` | boolean | จะรวมตัวอย่างก่อนและหลังในคำแนะนำหรือไม่ | `true` |
| `--auto-apply` | boolean | หากตั้งค่าเป็น `true` เวิร์กโฟลว์จะพยายามนำการปรับปรุงที่มีความเชื่อมั่นสูงไปใช้กับเทมเพลตพรอมต์ของคุณโดยอัตโนมัติ | `false` |

### พื้นที่ที่มุ่งเน้น (Focus Areas)

คุณสามารถจำกัดการวิเคราะห์ให้แคบลงในพื้นที่ที่สนใจเฉพาะ:

- **`accessibility`**: มุ่งเน้นไปที่ปัญหาที่เกี่ยวข้องกับการปฏิบัติตาม WCAG เช่น alt text ที่หายไปและคอนทราสต์สีต่ำ
- **`performance`**: วิเคราะห์เมตริกเช่นเวลาในการโหลดและความซับซ้อนของคอมโพเนนต์เพื่อแนะนำการเพิ่มประสิทธิภาพ
- **`engagement`**: ดูข้อมูลการโต้ตอบของผู้ใช้ เช่น อัตราการคลิก เพื่อปรับปรุง call-to-action และการโต้ตอบ
- **`usability`**: ระบุปัญหาที่ส่งผลต่อประสบการณ์ของผู้ใช้ เช่น อัตราข้อผิดพลาดสูงในฟอร์มหรือสไตล์ที่ไม่สอดคล้องกัน
- **`all`**: วิเคราะห์ทุกพื้นที่พร้อมกัน

## 4. ตัวอย่างการใช้งาน

นี่คือวิธีที่คุณสามารถใช้เวิร์กโฟลว์นี้เพื่อปรับปรุงพรอมต์ของคุณ

### กรณีการใช้งานที่ 1: การวิเคราะห์ทั่วไป

เพื่อรับรายงานที่ครอบคลุมเกี่ยวกับการปรับปรุงพรอมต์ที่เป็นไปได้ทั้งหมดตามการวิเคราะห์ล่าสุดของคุณ

**คำสั่ง:**
```bash
/smartspec_refine_agent_prompts \
  --analytics-file .spec/analytics/ui_analytics_latest.json
```

**ผลลัพธ์:** รายงาน markdown โดยละเอียดจะถูกสร้างขึ้นที่ `.spec/prompt_refinements.md` ซึ่งมีรายการคำแนะนำที่จัดลำดับความสำคัญในทุกพื้นที่ที่มุ่งเน้น

### กรณีการใช้งานที่ 2: การมุ่งเน้นไปที่การเข้าถึง (Accessibility)

สมมติว่าการตรวจสอบล่าสุดเปิดเผยปัญหาด้านการเข้าถึง คุณสามารถใช้เวิร์กโฟลว์เพื่อสร้างพรอมต์ที่สร้าง UI ที่เข้าถึงได้ง่ายขึ้นตั้งแต่เริ่มต้น

**คำสั่ง:**
```bash
/smartspec_refine_agent_prompts \
  --analytics-file .spec/analytics/ui_analytics_latest.json \
  --focus-area accessibility \
  --threshold 0.8
```

**ผลลัพธ์:** รายงานจะรวมเฉพาะคำแนะนำที่มีความเชื่อมั่นสูง (>= 0.8) ที่เกี่ยวข้องกับการปรับปรุงการเข้าถึงโดยเฉพาะ ตัวอย่างเช่น:

```markdown
## คำแนะนำการปรับปรุงการเข้าถึง

### ปัญหา: ไม่มี Alt Text (40% ของรูปภาพ)
**คำอธิบาย:** รูปภาพจำนวนมากในแอปพลิเคชันไม่มี alt text ที่ให้คำอธิบาย ทำให้ผู้ใช้ที่ใช้โปรแกรมอ่านหน้าจอไม่สามารถเข้าถึงได้

**รูปแบบพรอมต์ปัจจุบัน:**
"สร้างการ์ดผลิตภัณฑ์พร้อมรูปภาพของผลิตภัณฑ์"

**พรอมต์ที่ปรับปรุงแล้ว:**
"สร้างการ์ดผลิตภัณฑ์พร้อมรูปภาพของผลิตภัณฑ์ สำคัญ: รวม alt text ที่ให้คำอธิบายซึ่งอธิบายเนื้อหาและวัตถุประสงค์ของมันอย่างชัดเจน ตามแนวทาง WCAG 2.1"

**ผลกระทบที่คาดหวัง:** +40% คะแนนการเข้าถึง
**ความเชื่อมั่น:** 0.95
```

### กรณีการใช้งานที่ 3: การปรับปรุงรายสัปดาห์อัตโนมัติ

สำหรับวงจรการปรับปรุงอย่างต่อเนื่องอย่างแท้จริง คุณสามารถกำหนดเวลาให้เวิร์กโฟลว์นี้ทำงานทุกสัปดาห์และนำคำแนะนำที่น่าเชื่อถือที่สุดไปใช้โดยอัตโนมัติ

**คำสั่ง (สำหรับ cron job):**
```bash
/smartspec_refine_agent_prompts \
  --analytics-file .spec/analytics/ui_analytics_weekly.json \
  --output-format json \
  --auto-apply true \
  --threshold 0.9
```

**ผลลัพธ์:** เวิร์กโฟลว์จะทำงาน และคำแนะนำใดๆ ที่มีคะแนนความเชื่อมั่น 0.9 หรือสูงกว่าจะถูกนำไปใช้กับเทมเพลตพรอมต์ที่เกี่ยวข้องโดยอัตโนมัติ ทำให้มั่นใจได้ว่า AI agents ของคุณกำลังเรียนรู้และปรับปรุงอยู่เสมอ

## 5. การทำความเข้าใจผลลัพธ์

แต่ละคำแนะนำในรายงานจะให้ข้อมูลที่ชัดเจนและนำไปปฏิบัติได้:

- **คำอธิบายปัญหา:** คำอธิบายภาษาธรรมดาของปัญหาที่ระบุจากข้อมูลการวิเคราะห์
- **รูปแบบพรอมต์ปัจจุบัน:** ตัวอย่างของประเภทของพรอมต์ที่น่าจะทำให้เกิดปัญหา
- **พรอมต์ที่ปรับปรุงแล้ว:** เวอร์ชันของพรอมต์ที่ปรับปรุงแล้วและเป็นรูปธรรมซึ่งออกแบบมาเพื่อแก้ไขปัญหา
- **ผลกระทบที่คาดหวัง:** การคาดการณ์ผลลัพธ์เชิงบวกที่คุณคาดหวังได้จากการนำการปรับปรุงไปใช้
- **คะแนนความเชื่อมั่น:** คะแนนจาก 0.0 ถึง 1.0 ที่บ่งชี้ว่าเวิร์กโฟลว์มีความเชื่อมั่นเพียงใดว่าการปรับปรุงนี้จะแก้ปัญหาได้

## 6. เวิร์กโฟลว์ที่เกี่ยวข้อง

- **`smartspec_ui_analytics_reporter`**: แหล่งที่มาของข้อมูล เวิร์กโฟลว์นี้ต้องทำงานก่อนเพื่อรวบรวมการวิเคราะห์ที่ `smartspec_refine_agent_prompts` จะวิเคราะห์
- **`smartspec_ui_performance_test`**: ให้เมตริกประสิทธิภาพโดยละเอียดที่สามารถป้อนเข้าสู่ตัวรายงานการวิเคราะห์ได้
- **`smartspec_ui_accessibility_audit`**: สร้างคะแนนการเข้าถึงซึ่งเป็นข้อมูลป้อนเข้าที่สำคัญสำหรับเวิร์กโฟลว์นี้
