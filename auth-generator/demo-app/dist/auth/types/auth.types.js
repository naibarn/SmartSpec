"use strict";
/**
 * Auth Types
 *
 * Type definitions for authentication
 * Generated by SmartSpec Auth Generator
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.AUTH_ERRORS = exports.AuthError = exports.DEFAULT_AUTH_CONFIG = exports.ROLE_HIERARCHY = exports.UserRole = void 0;
exports.hasRole = hasRole;
/**
 * User roles
 */
var UserRole;
(function (UserRole) {
})(UserRole || (exports.UserRole = UserRole = {}));
/**
 * Role hierarchy for permission checking
 */
exports.ROLE_HIERARCHY = {};
/**
 * Check if user has required role or higher
 */
function hasRole(userRole, requiredRole) {
    return exports.ROLE_HIERARCHY[userRole] >= exports.ROLE_HIERARCHY[requiredRole];
}
/**
 * Default auth configuration
 */
exports.DEFAULT_AUTH_CONFIG = {
    jwt: {
        algorithm: 'RS256',
        accessTokenExpiry: '15m',
        refreshTokenExpiry: '7d',
        issuer: 'smartspec-app',
        audience: 'smartspec-users',
    },
    password: {
        minLength: 8,
        requireUppercase: false,
        requireLowercase: false,
        requireNumbers: false,
        requireSpecialChars: false,
        saltRounds: 10,
    },
    accountLockout: {
        maxAttempts: 5,
        lockoutDuration: 30,
    },
    emailVerification: {
        tokenExpiry: 24, // 24 hours
    },
    passwordReset: {
        tokenExpiry: 1, // 1 hour
    },
};
/**
 * Auth errors
 */
class AuthError extends Error {
    constructor(message, code, statusCode = 400) {
        super(message);
        this.code = code;
        this.statusCode = statusCode;
        this.name = 'AuthError';
    }
}
exports.AuthError = AuthError;
exports.AUTH_ERRORS = {
    INVALID_CREDENTIALS: new AuthError('Invalid credentials', 'INVALID_CREDENTIALS', 401),
    USER_EXISTS: new AuthError('User already exists', 'USER_EXISTS', 409),
    USER_NOT_FOUND: new AuthError('User not found', 'USER_NOT_FOUND', 404),
    INVALID_TOKEN: new AuthError('Invalid or expired token', 'INVALID_TOKEN', 401),
    WEAK_PASSWORD: new AuthError('Password does not meet requirements', 'WEAK_PASSWORD', 400),
    ACCOUNT_LOCKED: new AuthError('Account is locked due to too many failed login attempts', 'ACCOUNT_LOCKED', 423),
    EMAIL_NOT_VERIFIED: new AuthError('Email not verified', 'EMAIL_NOT_VERIFIED', 403),
    UNAUTHORIZED: new AuthError('Unauthorized', 'UNAUTHORIZED', 401),
    FORBIDDEN: new AuthError('Insufficient permissions', 'FORBIDDEN', 403),
};
//# sourceMappingURL=auth.types.js.map